<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptidium UI</title>
    <!-- Load React from CDN -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: sans-serif;
        }
        .tab-bar {
            display: flex;
            align-items: center;
            height: 32px;
            background: #2e005e;
            color: white;
            user-select: none;
        }
        .tab {
            padding: 6px 12px;
            margin-right: 2px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px 4px 0 0;
            cursor: pointer;
        }
        .tab.active {
            background: #ffffff;
            color: #2e005e;
        }
        .tab .close {
            margin-left: 6px;
            color: inherit;
            cursor: pointer;
        }
        .new-tab-button {
            margin-left: auto;
            padding: 0 12px;
            cursor: pointer;
        }
        .nav-bar {
            display: flex;
            align-items: center;
            height: 32px;
            background: #ececec;
            padding: 0 4px;
        }
        .nav-bar button {
            margin-right: 4px;
        }
        .nav-bar input {
            flex: 1;
            height: 24px;
            margin-right: 4px;
        }
        .content {
            position: absolute;
            top: 64px;
            left: 0;
            right: 0;
            bottom: 0;
        }
        .content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        const { useState } = React;

        function BrowserApp() {
            const [tabs, setTabs] = useState(() => {
                return [{ id: 1, url: 'https://google.com' }];
            });
            const [currentId, setCurrentId] = useState(1);
            const [urlInput, setUrlInput] = useState('https://google.com');

            const addTab = () => {
                const nextId = tabs.length ? Math.max(...tabs.map(t => t.id)) + 1 : 1;
                const newTab = { id: nextId, url: 'https://google.com' };
                setTabs([...tabs, newTab]);
                setCurrentId(nextId);
                setUrlInput(newTab.url);
            };

            const closeTab = (id) => {
                let newTabs = tabs.filter(t => t.id !== id);
                if (newTabs.length === 0) {
                    newTabs = [{ id: 1, url: 'https://google.com' }];
                }
                setTabs(newTabs);
                if (currentId === id) {
                    setCurrentId(newTabs[0].id);
                    setUrlInput(newTabs[0].url);
                }
            };

            const selectTab = (id) => {
                setCurrentId(id);
                const t = tabs.find(t => t.id === id);
                setUrlInput(t.url);
            };

            const navigate = () => {
                setTabs(tabs.map(t => {
                    if (t.id === currentId) {
                        return { ...t, url: urlInput };
                    }
                    return t;
                }));
            };

            const onKeyDown = (e) => {
                if (e.key === 'Enter') {
                    navigate();
                }
            };

            return (
                React.createElement('div', { style: { height: '100%', display: 'flex', flexDirection: 'column' } },
                    React.createElement('div', { className: 'tab-bar' },
                        tabs.map(tab =>
                            React.createElement('div', {
                                key: tab.id,
                                className: 'tab' + (tab.id === currentId ? ' active' : ''),
                                onClick: () => selectTab(tab.id)
                            },
                                'Tab ', tab.id,
                                React.createElement('span', {
                                    className: 'close',
                                    onClick: (e) => { e.stopPropagation(); closeTab(tab.id); }
                                }, 'Ã—')
                            )
                        ),
                        React.createElement('div', { className: 'new-tab-button', onClick: addTab }, '+')
                    ),
                    React.createElement('div', { className: 'nav-bar' },
                        React.createElement('button', { onClick: () => { /* back placeholder */ } }, '<'),
                        React.createElement('button', { onClick: () => { /* forward placeholder */ } }, '>'),
                        React.createElement('button', { onClick: () => { /* refresh */ } }, 'R'),
                        React.createElement('input', {
                            value: urlInput,
                            onChange: e => setUrlInput(e.target.value),
                            onKeyDown
                        }),
                        React.createElement('button', { onClick: navigate }, 'Go')
                    ),
                    React.createElement('div', { className: 'content' },
                        tabs.map(tab =>
                            tab.id === currentId
                                ? React.createElement('iframe', { key: tab.id, src: tab.url, sandbox: '' })
                                : null
                        )
                    )
                )
            );
        }

        ReactDOM.render(React.createElement(BrowserApp), document.getElementById('root'));
    </script>
</body>
</html>